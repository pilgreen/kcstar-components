---
layout: page
title: responsive-table
permalink: /responsive-table/
tags: data
excerpt: This element shows data copied from a Google Spreadsheet and has a few formatting options.
img: img/responsive-table.png
---

<link rel="import" href="components/responsive-table.html">
<link rel="import" href="bower_components/paper-toggle-button/paper-toggle-button.html">

<p>Paste data from a Google Spreadsheet into the box below. Please include a header row.</p>

<section>
  <label>Spreadsheet data</label>
  <textarea id="rawdata"></textarea>
</section>

<section class="horizontal center-justified layout">
  <button id="start">get started</button>
</section>

<div id="settings" hidden>
  <section>
    <h3 class="title">Column settings</h3>
    <div id="headers"></div>

    <h3 class="title">Options</h3>
    <paper-toggle-button id="zebra" class="sans-cond">Zebra striping</paper-toggle-button>
  </section>

  <section>
    <h3 class="title">Preview</h3>
    <div id="preview"></div>
  </section>

  <section>
    <label>Copy this code</label>
    <textarea id="code"></textarea>
  </section>
</div>


<!-- Template helpers -->
<template data-role="row">
  <div class="horizontal center layout row sans-cond">
    <h4 class="flex"></h4>
    <paper-toggle-button class="flex number">Number</paper-toggle-button>
    <paper-toggle-button class="flex mobile">Mobile</paper-toggle-button>
  </div>
</template>

<template data-role="preview">
  <table is="responsive-table">
    <thead><tr></tr></thead>
    <tbody></tbody>
  </table>
</template>


<!-- Page script -->
<script>
  var settings = document.querySelector('#settings');
  var preview = document.querySelector('#preview');
  var code = document.querySelector('#code');
  var data;

  // Events
  document.querySelector('#start').addEventListener('click', handleClick);
  window.addEventListener('iron-change', redraw);

  function handleClick() {
    var raw = document.querySelector('#rawdata').value;
    var rows = raw.split(/\n/);

    data = {
      head: rows.shift().split(/\t/),
      body: rows.map(function(d) {
        return d.split(/\t/);
      })
    }

    var h = document.querySelector('#headers');
    var t = document.querySelector('template[data-role="row"]');
    var mobile = t.content.querySelector('.mobile');
    var number = t.content.querySelector('.number');

    h.innerHTML = '';

    data.head.forEach(function(d, i) {
      t.content.querySelector('h4').textContent = d;

      number.setAttribute('data-column', d);
      if(!isNaN(parseFloat(data.body[0][i]))) number.setAttribute('checked', true);
      else number.removeAttribute('checked');

      mobile.setAttribute('data-column', d);
      if(i < 4) mobile.setAttribute('checked', true);
      else mobile.removeAttribute('checked');

      var clone = document.importNode(t.content, true);
      h.appendChild(clone);
    });

    settings.removeAttribute('hidden');
    redraw();
  }

  function redraw() {
    var t = document.querySelector('template[data-role="preview"]');
    var table = t.content.querySelector('table');
    var thead = t.content.querySelector('thead tr');
    var tbody = t.content.querySelector('tbody');

    table.classList.toggle('zebra', document.querySelector('#zebra').checked);

    thead.innerHTML = '';
    tbody.innerHTML = '';

    data.head.forEach(function(d) {
      var th = document.createElement('th');
      th.textContent = d;
      th.classList.toggle('number', document.querySelector(`paper-toggle-button[data-column="${d}"].number`).checked);
      th.classList.toggle('mobile', document.querySelector(`paper-toggle-button[data-column="${d}"].mobile`).checked);
      thead.appendChild(th);
    });

    data.body.forEach(function(d) {
      var tr = document.createElement('tr');
      d.forEach(function(t, i) {
        var td = document.createElement('td');
        td.textContent = t;
        td.classList.toggle('number', document.querySelector(`paper-toggle-button[data-column="${data.head[i]}"].number`).checked);
        td.classList.toggle('mobile', document.querySelector(`paper-toggle-button[data-column="${data.head[i]}"].mobile`).checked);
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });

    preview.innerHTML = '';
    preview.appendChild(document.importNode(t.content, true));

    code.value = formatCode(t.innerHTML, ['components/responsive-table.html']);
  }
</script>
