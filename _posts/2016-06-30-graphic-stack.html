---
layout: page
title: graphic-stack
permalink: /graphic-stack/
tags: graphics
excerpt: This element shows a single image in the body of a story.
img: img/graphic-stack.png
---

<link rel="import" href="bower_components/iron-selector/iron-selector.html">
<link rel="import" href="components/graphic-stack.html">

<style>
  #markup {
    margin: 0;
    overflow: auto;
  }

  #markup :first-child {
    margin-top: 0;
  }
</style>

<section>
  <label>Image URL <small>Desktop or single</small></label>
  <input type="text" name="desktopImage">

  <label>Image URL <small>Mobile</small></label>
  <input type="text" name="mobileImage">

  <label>Content <small><a href="markdown-preview/" target="_blank">markdown enabled</a></small></label>
  <textarea name="content"></textarea>

  <label>Positioning</label>
  <iron-selector id="position" class="horizontal layout" attr-for-selected="name" selected="full">
    <span class="button" name="full">full</span>
    <span class="button" name="left">left</span>
    <span class="button" name="right">right</span>
  </iron-selector>
</section>

<section class="horizontal center-justified layout">
  <button class="generate">generate code</button>
</section>

<div id="settings" hidden>
  <section>
    <h3 class="title">Preview</h3>
    <div id="preview" class="clearfix"></div>
  </section>

  <section>
    <label>Copy this code</label>
    <textarea id="code" class="pre" readonly></textarea>
  </section>
</div>

<!-- Template content -->
<template>
  <graphic-stack>
    <img class="desktop"></img>
    <img class="mobile"></img>
    <div class="graphic-stack-content">
      <!-- empty to start -->
    </div>
  </graphic-stack>
</template>

<!-- Page script -->
<script>
  var settings = document.querySelector('#settings');
  var preview = document.querySelector('#preview');
  var code = document.querySelector('#code');
  var markup = document.querySelector('#markup');

  marked.setOptions({
    sanitize: true
  });

  // Events
  document.querySelector('button').addEventListener('click', handleClick);

  function handleClick() {
    var v = {
      desktop: document.querySelector('input[name="desktopImage"]').value,
      mobile: document.querySelector('input[name="mobileImage"]').value,
      content: marked(document.querySelector('textarea[name="content"]').value),
      position: document.querySelector('#position').selected
    }

    var t = document.querySelector('template');
    var stack = t.content.querySelector('graphic-stack');
    var desktop = stack.querySelector('.desktop');
    var mobile = stack.querySelector('.mobile');
    var content = stack.querySelector('.graphic-stack-content');

    stack.setAttribute('position', v.position);
    desktop.src = v.desktop ? v.desktop : '';
    mobile.src = v.mobile ? v.mobile : '';
    desktop.classList.toggle('single', !v.mobile)
    content.innerHTML = v.content.trim();

    preview.innerHTML = '';
    preview.appendChild(document.importNode(t.content, true));

    code.value = sanitize(t.innerHTML, ['bower_components/kcstar-webcomponents/graphic-stack.html']);
    settings.removeAttribute('hidden');
  }
</script>

