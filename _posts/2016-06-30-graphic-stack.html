---
layout: page
title: graphic-stack
permalink: /graphic-stack/
tags: graphics
excerpt: The `graphic-stack` element provides structure for a single image in the body of a story.
---

<link rel="import" href="components/graphic-stack.html">

<label class="sans-cond">Image URL <small>(Desktop or single)</small></label>
<input type="text" class="space" name="desktopImage">

<label class="sans-cond">Image URL <small>(Mobile)</small></label>
<input type="text" class="space" name="mobileImage">

<label class="sans-cond">Content</label>
<textarea name="content" class="space"></textarea>

<label class="sans-cond">Positioning</label>
<div class="horizontal layout space">
  <label><input type="radio" name="position" value="full" checked>full</label>
  <label><input type="radio" name="position" value="left">left</label>
  <label><input type="radio" name="position" value="right">right</label>
</div>

<button class="generate">generate code</button>

<div id="preview" class="clearfix"></div>
<label class="sans-cond">Copy this code</label>
<textarea id="code" class="nowrap"></textarea>

<!-- Template content -->
<template>
  <graphic-stack>
    <img class="desktop">
    <img class="mobile">
    <div class="content"></div>
  </graphic-stack>
</template>

<!-- Page script -->
<script>
  var b = document.querySelector('button');
  b.addEventListener('click', handleClick);

  function handleClick() {
    var v = {
      desktop: document.querySelector('input[name="desktopImage"]').value,
      mobile: document.querySelector('input[name="mobileImage"]').value,
      content: marked(document.querySelector('textarea[name="content"]').value),
      position: document.querySelector('input[name="position"]:checked').value
    }

    generatePreview(v);
    generateCode(v);
  }

  function generatePreview(v) {
    var t = document.querySelector('template');
    var stack = t.content.querySelector('graphic-stack');
    var preview = document.querySelector('#preview');

    stack.setAttribute('position', v.position);
    stack.querySelector('.desktop').src = v.desktop ? v.desktop : '';
    stack.querySelector('.mobile').src = v.mobile ? v.mobile : '';
    stack.querySelector('.content').innerHTML = v.content;

    while(preview.firstChild) {
      preview.removeChild(preview.firstChild);
    }

    var clone = document.importNode(t.content, true);
    preview.appendChild(clone);
  }

  function generateCode(v) {
    var code = document.querySelector('#code');
    var imgString = v.mobile ? `<img class="desktop" src="${v.desktop}">\n<img class="mobile" src="${v.mobile}">` : `<img src="${v.desktop}">`

    code.value = `
<link rel="import" href="https://pilgreen.github.io/kcstar-webcomponents/components/graphic-stack.html">
<graphic-stack position="${v.position}">
${imgString.trim()}
${v.content.trim()}
</graphic-stack>`.trim();
  }
</script>

